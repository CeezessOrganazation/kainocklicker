<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KainoClicker</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="game-container">
  <h1>KainoClicker</h1>
  <p id="prestigeDisplay">Prestige Points: 0</p>
  <p>Coins: <span id="coinDisplay">0</span></p>
  <p>Coins/sec: <span id="cpsDisplay">0</span></p>
  <p>Click Power: <span id="clickPowerDisplay">1</span></p>
  
  <button id="coinButton">Click me!</button>
  
  <div>
    <button class="themeButton" onclick="setTheme('default')">Default</button>
    <button class="themeButton" onclick="setTheme('flavorfoley')">spirit</button>
    <button class="themeButton" onclick="setTheme('cookie')">Cookie</button>
    <button class="themeButton" onclick="setTheme('uwu')">Uwu</button>
  </div>
  
  <div id="shop"></div>
  
  <button id="rebirthBtn" disabled style="margin-top:20px;">Rebirth (Locked)</button>
  
  <p>Achievements:</p>
  <ul id="achievements"></ul>

  <div id="devControls" style="display: none; margin-top: 20px; padding: 10px; background: rgba(255,0,0,0.1); border: 1px solid red;">
    <h3>Developer Controls</h3>
    <div>
      <label for="coinInput">Set Coins:</label>
      <input type="number" id="coinInput" value="0">
      <button onclick="setCoins()">Set</button>
    </div>
    <div style="margin-top: 10px;">
      <label for="devMultiplier">Multiplier:</label>
      <input type="number" id="devMultiplier" value="1" min="1">
      <button onclick="setMultiplier()">Set</button>
    </div>
  </div>
</div>

<script>
let coins = 0;
let clickPower = 1;
let coinsPerSecond = 0;
let prestigePoints = 0;
let prestigeMultiplier = 1;
const rebirthThreshold = 5000;

// Shop items
const items = {
  glove: { name: "Glove", clickPower: 0.1, cps: 0, cost: 10, owned: 0, requiresRebirth: false },
  cursor: { name: "Cursor", clickPower: 0, cps: 0.1, cost: 50, owned: 0, requiresRebirth: true },
  hand: { name: "Hand", clickPower: 0, cps: 1, cost: 500, owned: 0, requiresRebirth: true },
  factory: { name: "Factory", clickPower: 0, cps: 8, cost: 1000, owned: 0, requiresRebirth: true },
  automaton: { name: "Automaton", clickPower: 0, cps: 50, cost: 5000, owned: 0, requiresRebirth: true }
};

// Achievements
const achievements = [
  { name: "First Click", condition: () => coins >= 1, unlocked: false },
  { name: "Hundred Coins", condition: () => coins >= 100, unlocked: false },
  { name: "Big Spender", condition: () => items.factory.owned >= 1, unlocked: false }
];

// Themes
const themes = {
  default: { bg: "#111", buttonBg: "#222", buttonBorder: "#fff", color: "#fff", font: "Orbitron, sans-serif" },
  flavorfoley: { bg: "#360f5a", buttonBg: "#522081", buttonBorder: "#FFD700", color: "#FFD700", font: "'Orbitron', sans-serif" },
  cookie: { bg: "#a0522d", buttonBg: "#d2691e", buttonBorder: "#fff", color: "#fff", font: "Arial, sans-serif" },
  uwu: { bg: "#ffc0cb", buttonBg: "#ffb6c1", buttonBorder: "#87CEEB", color: "#87CEEB", font: "'Comic Sans MS', cursive, sans-serif" }
};

// Initialize shop
function updateShop() {
  const shopDiv = document.getElementById("shop");
  shopDiv.innerHTML = "";
  for (const key in items) {
    const item = items[key];
    const div = document.createElement("div");
    div.className = "shop-item";
    let buttonHtml = `<button onclick="buyItem('${key}')" ${item.requiresRebirth && prestigePoints === 0 ? 'disabled' : ''}>Buy</button>`;
    div.innerHTML = `<strong>${item.name}</strong><br>
                     Click Power: ${item.clickPower}<br>
                     CPS: ${item.cps}<br>
                     Owned: ${item.owned}<br>
                     Cost: ${item.cost}<br>
                     ${item.requiresRebirth ? '<span style="color: #ff69b4;">Requires Rebirth!</span><br>' : ''}
                     ${buttonHtml}`;
    shopDiv.appendChild(div);
  }
}

// Buy item
function buyItem(key) {
  const item = items[key];
  if (item.requiresRebirth && prestigePoints === 0) {
    alert("You need to rebirth at least once to buy this item!");
    return;
  }
  if (coins >= item.cost) {
    coins -= item.cost;
    item.owned++;
    item.cost = Math.floor(item.cost * 1.15);
    recalcCPS();
    recalcClickPower();
    updateDisplay();
    updateShop();
    saveGame();
  }
}

// Recalculate CPS
function recalcCPS() {
  coinsPerSecond = 0;
  for (const key in items) {
    coinsPerSecond += items[key].cps * items[key].owned;
  }
  coinsPerSecond *= prestigeMultiplier;
}

// Recalculate click power
function recalcClickPower() {
  // Start with base click power
  clickPower = 1;
  // Add item bonuses
  for (const key in items) {
    clickPower += items[key].clickPower * items[key].owned;
  }
  // Apply prestige multiplier only to the total
  clickPower = clickPower * prestigeMultiplier;
}

// Click
document.getElementById("coinButton").addEventListener("click", () => {
  coins += clickPower;
  updateDisplay();
  saveGame();
});

// Update display
function updateDisplay() {
  document.getElementById("coinDisplay").textContent = coins.toFixed(1);
  document.getElementById("cpsDisplay").textContent = coinsPerSecond.toFixed(1);
  document.getElementById("clickPowerDisplay").textContent = clickPower.toFixed(1);
  document.getElementById("prestigeDisplay").textContent = `Prestige Points: ${prestigePoints}`;
  checkAchievements();
  checkRebirth();
}

// Achievements
function checkAchievements() {
  const ul = document.getElementById("achievements");
  ul.innerHTML = "";
  achievements.forEach(a => {
    if (!a.unlocked && a.condition()) a.unlocked = true;
    if (a.unlocked) {
      const li = document.createElement("li");
      li.textContent = a.name;
      ul.appendChild(li);
    }
  });
}

// Themes
function setTheme(name) {
  const theme = themes[name];
  document.body.style.background = theme.bg;
  document.body.style.color = theme.color;
  document.body.style.fontFamily = theme.font;
  const btn = document.getElementById("coinButton");
  btn.style.background = theme.buttonBg;
  btn.style.borderColor = theme.buttonBorder;
}

// Passive income + check rebirth
setInterval(() => {
  coins += coinsPerSecond / 5; // 5 Ã— 200ms = 1s
  updateDisplay();
}, 200);

// Rebirth
const rebirthBtn = document.getElementById("rebirthBtn");
rebirthBtn.onclick = () => {
  if (coins >= rebirthThreshold) {
    prestigePoints++;
    prestigeMultiplier = prestigePoints + 1; // Linear increase: 1st=1x, 2nd=2x, 3rd=3x, etc.
    coins = 0;
    for (const key in items) items[key].owned = 0;
    recalcCPS();
    updateDisplay();
    updateShop();
    alert(`You rebirthed! Prestige Points: ${prestigePoints} (${prestigeMultiplier}x multiplier)`);
    saveGame();
  }
};

function checkRebirth() {
  if (coins >= rebirthThreshold) {
    rebirthBtn.textContent = "Rebirth!";
    rebirthBtn.disabled = false;
  } else {
    rebirthBtn.textContent = `Rebirth (Locked: ${rebirthThreshold - Math.floor(coins)} more coins)`;
    rebirthBtn.disabled = true;
  }
}

// Save game
function saveGame() {
  const gameData = {
    coins,
    clickPower,
    coinsPerSecond,
    prestigePoints,
    prestigeMultiplier,
    items,
    achievements
  };
  localStorage.setItem('kainoClickerSave', JSON.stringify(gameData));
}

// Load game
function loadGame() {
  const savedGame = localStorage.getItem('kainoClickerSave');
  if (savedGame) {
    const gameData = JSON.parse(savedGame);
    coins = gameData.coins;
    clickPower = gameData.clickPower;
    coinsPerSecond = gameData.coinsPerSecond;
    prestigePoints = gameData.prestigePoints;
    prestigeMultiplier = gameData.prestigeMultiplier;
    
    // Restore items
    for (const key in gameData.items) {
      if (items[key]) {
        items[key].owned = gameData.items[key].owned;
        items[key].cost = gameData.items[key].cost;
      }
    }
    
    // Restore achievements
    gameData.achievements.forEach((achievement, index) => {
      if (achievements[index]) {
        achievements[index].unlocked = achievement.unlocked;
      }
    });
  }
}

// Auto-save every 30 seconds
setInterval(saveGame, 30000);

// Dev mode functions
let devMode = false;

function toggleDevMode() {
  if (!devMode && prompt("Enter dev mode password:") === "CEEZESS") {
    devMode = true;
    document.getElementById("devControls").style.display = "block";
  } else if (devMode) {
    devMode = false;
    document.getElementById("devControls").style.display = "none";
  }
}

function setCoins() {
  if (!devMode) return;
  const amount = parseInt(document.getElementById("coinInput").value) || 0;
  if (amount < 0) return; // Prevent negative coins
  coins = amount;
  updateDisplay();
  saveGame();
  // Clear input after setting
  document.getElementById("coinInput").value = "";
}

function setMultiplier() {
  if (!devMode) return;
  const multi = parseInt(document.getElementById("devMultiplier").value) || 1;
  if (multi < 1) return; // Prevent multiplier less than 1
  prestigeMultiplier = multi;
  prestigePoints = multi - 1; // Update prestige points to match multiplier
  recalcCPS();
  recalcClickPower();
  updateDisplay();
  saveGame();
}

// Dev mode activation with triple D press
let dPressCount = 0;
let lastDPressTime = 0;

document.addEventListener('keydown', (e) => {
  if (e.key.toLowerCase() === 'd') {
    const currentTime = Date.now();
    
    // Reset count if it's been more than 1 second since last press
    if (currentTime - lastDPressTime > 1000) {
      dPressCount = 0;
    }
    
    dPressCount++;
    lastDPressTime = currentTime;
    
    // Check if we've pressed D three times quickly
    if (dPressCount === 3) {
      dPressCount = 0;
      toggleDevMode();
    }
  }
});

// Initialize
loadGame();
updateShop();
updateDisplay();
setTheme('default');
</script>
</body>
</html>
